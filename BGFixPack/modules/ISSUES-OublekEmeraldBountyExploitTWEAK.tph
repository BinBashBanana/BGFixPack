//ISSUES-OublekEmeraldBountyExploitTWEAK.tph
PRINT ~Processing ISSUES-OublekEmeraldBountyExploitTWEAK.tph~
// ----------------------------------------------------------------------------
//BEGIN @7 //~Optional: Oublek & Prism - No Exploit & Multiple Ways to Solve Quest~
//REQUIRE_COMPONENT ~Setup-BGFixPack.tp2~ ~0~ @3 //~SKIPPING Required Component not installed~
//INCLUDE ~bgfixpack\tph\wapt.tph~ //definitions for the various Weidu Area Patching Tool macros and functions
LAUNCH_ACTION_FUNCTION ~wapt_add_container~
INT_VAR //integer variables
wapt_num_new_Conta = 2
//data for container 1
wapt_use_point_x_1 = 641 wapt_use_point_y_1 = 2713 wapt_type_1 = 6 wapt_lock_diff_1 = 30 wapt_flags_1 = 0b00000001 wapt_trap_detect_diff_1 = 100 wapt_trap_disarm_diff_1 = 100 wapt_trap_launch_x_1 = 641 wapt_trap_launch_y_1 = 2713 wapt_num_items_1 = 1 wapt_vertices_1 = 6
//data for container 2
wapt_use_point_x_2 = 641 wapt_use_point_y_2 = 2713 wapt_type_2 = 6 wapt_lock_diff_2 = 70 wapt_flags_2 = 0b00000001 wapt_trap_detect_diff_2 = 100 wapt_trap_disarm_diff_2 = 100 wapt_trap_launch_x_2 = 641 wapt_trap_launch_y_2 = 2713 wapt_num_items_2 = 1 wapt_vertices_2 = 6
//Vertex points for container 1:
wapt_vx_1 = 564 wapt_vy_1 = 2559 wapt_vx_2 = 578 wapt_vy_2 = 2552 wapt_vx_3 = 590 wapt_vy_3 = 2556 wapt_vx_4 = 586 wapt_vy_4 = 2561 wapt_vx_5 = 580 wapt_vy_5 = 2563 wapt_vx_6 = 570 wapt_vy_6 = 2562
//Vertex points for container 2:
wapt_vx_7 = 638 wapt_vy_7 = 2544 wapt_vx_8 = 635 wapt_vy_8 = 2550 wapt_vx_9 = 627 wapt_vy_9 = 2554 wapt_vx_10 = 614 wapt_vy_10 = 2555 wapt_vx_11 = 626 wapt_vy_11 = 2543 wapt_vx_12 = 635 wapt_vy_12 = 2541
STR_VAR //string variables
wapt_area = ~ar5400~ wapt_object_name_1 = ~A6StatueRightEye~ wapt_object_name_2 = ~A6StatueLeftEye~
END //end launch command
//create left eye emerald
COPY_EXISTING ~misc43.itm~ ~override/abgfEyeL.itm~
 SAY UNIDENTIFIED_DESC ~An Emerald is a brilliant green beryl, cleaved along straight box like lines, with rectangular cutting in the finished gem.  Emeralds are often connected with health, and so are used ornamentally for such a purpose. This emerald is marked with a small 'L'. It had been stolen by Prism for his use in a statue of his lady love, Ellesime. It is surmised that this gem was intended to be used as the left eye. Whether or not it was used in the statue, there is a bounty for returning it to the proper authorities.~
 SAY IDENTIFIED_DESC ~An Emerald is a brilliant green beryl, cleaved along straight box like lines, with rectangular cutting in the finished gem.  Emeralds are often connected with health, and so are used ornamentally for such a purpose. This emerald is marked with a small 'L'. It had been stolen by Prism for his use in a statue of his lady love, Ellesime. It is surmised that this gem was intended to be used as the left eye. Whether or not it was used in the statue, there is a bounty for returning it to the proper authorities.~
BUT_ONLY_IF_IT_CHANGES
//create right eye emerald
COPY_EXISTING ~misc43.itm~ ~override/abgfEyeR.itm~
 SAY UNIDENTIFIED_DESC ~An Emerald is a brilliant green beryl, cleaved along straight box like lines, with rectangular cutting in the finished gem.  Emeralds are often connected with health, and so are used ornamentally for such a purpose. This emerald is marked with a small 'R'. It had been stolen by Prism for his use in a statue of his lady love, Ellesime. It is surmised that this gem was intended to be used as the right eye. Whether or not it was used in the statue, there is a bounty for returning it to the proper authorities.~
 SAY IDENTIFIED_DESC ~An Emerald is a brilliant green beryl, cleaved along straight box like lines, with rectangular cutting in the finished gem.  Emeralds are often connected with health, and so are used ornamentally for such a purpose. This emerald is marked with a small 'R'. It had been stolen by Prism for his use in a statue of his lady love, Ellesime. It is surmised that this gem was intended to be used as the right eye. Whether or not it was used in the statue, there is a bounty for returning it to the proper authorities.~
BUT_ONLY_IF_IT_CHANGES
//change the emeralds that prism carries
COPY_EXISTING ~prism.cre~ ~override~
 REMOVE_CRE_ITEM ~misc43~
 REPLACE_CRE_ITEM ~abgfEyeL~ #1 #0 #0 ~identified~ ~qitem1~
 REPLACE_CRE_ITEM ~abgfEyeR~ #1 #0 #0 ~identified~ ~qitem2~
BUT_ONLY_IF_IT_CHANGES
//compile the dialog changes to oublek and prism
COPY ~bgfixpack/files/oublek/oublek.dlg~ ~override~ //replace earlier 'fixed' file with original cause it is easier than trying to undo the changes made to all versions
COMPILE ~bgfixpack/files/oublek/oublek.d~
//check existance of area script and add rep penalty for taking gems from statue
COPY_EXISTING ~ar5400.are~ ~override~
 LAUNCH_PATCH_MACRO ~wapt_header_initvars~
 INNER_ACTION BEGIN
  EXTEND_BOTTOM ~%wapt_h_AreBS%.bcs~ ~bgfixpack/files/oublek/ar5400.baf~ //add our stuff -- creates new if doesn't exist
 END
BUT_ONLY_IF_IT_CHANGES
//check existance of area script and add global sets to complete quest
COPY_EXISTING ~ar4800.are~ ~override~
 LAUNCH_PATCH_MACRO ~wapt_header_initvars~
 INNER_ACTION BEGIN
  EXTEND_BOTTOM ~%wapt_h_AreBS%.bcs~ ~bgfixpack/files/oublek/ar4800.baf~ //add our stuff -- creates new if doesn't exist
 END
BUT_ONLY_IF_IT_CHANGES
