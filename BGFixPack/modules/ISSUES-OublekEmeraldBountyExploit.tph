//ISSUES-OublekEmeraldBountyExploit.tph
PRINT ~Processing ISSUES-OublekEmeraldBountyExploit.tph~
// ----------------------------------------------------------------------------
//Oublek Emerald Bounty Exploit Fix
// An attempt to fix Oublek and the Bounty exploits
<<<<<<<< inlined/oublek.d
//OublekBounty1 is for brage
//OublekBounty2 is for prism
ADD_TRANS_TRIGGER ~oublek~ 9 ~Global("OublekBounty1","GLOBAL",0)~ DO 0
ADD_TRANS_TRIGGER ~oublek~ 9 ~Global("OublekBounty2","GLOBAL",0)~ DO 1
ADD_TRANS_TRIGGER ~oublek~ 9 ~Global("OublekBounty1","GLOBAL",0)
Global("OublekBounty2","GLOBAL",0)~ DO 4
ADD_TRANS_TRIGGER ~oublek~ 10 ~Global("OublekBounty1","GLOBAL",0)~ DO 1 5
ADD_TRANS_TRIGGER ~oublek~ 10 ~Global("OublekBounty2","GLOBAL",0)~ DO 9 5
>>>>>>>>
COMPILE ~inlined/oublek.d~
ACTION_IF (GAME_IS ~totsc~) THEN BEGIN
//put this in a library file at some point if it works
OUTER_INNER_PATCH ~12~ BEGIN
  WRITE_BYTE 1 0x09
  READ_ASCII 1 tab (1)  // 0x09, tab
  WRITE_BYTE 1 0x0a
  READ_ASCII 1 lnl (1)  // 0x0a, Linux
  WRITE_BYTE 0 0x0d
  READ_ASCII 0 mnl (1)  // 0x0d, Mac
  READ_ASCII 0 wnl (2)  // 0x0d0a, Windows
END
APPEND ~trigger.ids~ ~0x407A NumItemsParty(S:ResRef*,I:Num*)~
              UNLESS ~0x407A[ %tab%]+NumItemsParty(S:ResRef\*,I:Num\*)~
APPEND ~trigger.ids~ ~0x407B NumItemsPartyGT(S:ResRef*,I:Num*)~
              UNLESS ~0x407B[ %tab%]+NumItemsPartyGT(S:ResRef\*,I:Num\*)~
APPEND ~trigger.ids~ ~0x407C NumItemsPartyLT(S:ResRef*,I:Num*)~
              UNLESS ~0x407C[ %tab%]+NumItemsPartyLT(S:ResRef\*,I:Num\*)~
<<<<<<<< inlined/oublek.d
ADD_TRANS_TRIGGER ~oublek~ 9 ~NumItemsPartyLT("misc43",2)~ DO 4
ADD_TRANS_TRIGGER ~oublek~ 10 ~NumItemsPartyLT("misc43",2)~ DO 5
REPLACE_TRANS_TRIGGER oublek BEGIN 9 END BEGIN 1 END ~PartyHasItem("MISC43")~ ~NumItemsPartyGT("MISC43",1)~
REPLACE_TRANS_TRIGGER oublek BEGIN 10 END BEGIN 9 END ~PartyHasItem("MISC43")~ ~NumItemsPartyGT("MISC43",1)~
>>>>>>>>
COMPILE ~inlined/oublek.d~
END
